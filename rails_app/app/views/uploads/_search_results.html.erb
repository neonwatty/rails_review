<% if @uploads.present? %>
  <div class="flex flex-col items-center justify-center" id="search-results-returned">
    <button 
          onclick="window.location.reload();" 
          class="btn btn-primary btn-sm"
          aria-label="Refresh"
        >
      <i class="fas fa-sync"></i>
    </button>
    <div class="w-full h-5"></div>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th><label><input type="checkbox" class="checkbox hidden" disabled></label></th>
        <th>Input</th>
        <th>Output</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @uploads.each_with_index do |upload, index| %>
        <% if upload.files.attached? %>
          <% input_file = upload.files.first %>
          <% if input_file.representable? %>
            <tr>
              <th>
                <input type="checkbox" 
                   class="checkbox hidden" 
                   id="checkbox-<%= index %>"
                   disabled>
              </th>
              <td>
                <div class="flex items-center gap-3">
                  <div class="avatar">
                    <div class="w-12 h-12 mask mask-squircle">
                      <%= image_tag input_file.variant(:thumb) %>
                    </div>
                  </div>
                  <div>
                    <div class="font-bold"><%= input_file.filename.to_s %></div>
                    <div class="text-sm opacity-50"><%= input_file.created_at.to_s %></div>
                  </div>
                </div>
              </td>
              <td>
                <% if upload.files.attached? && upload.files.count > 1 %>
                  <% output_file = upload.files.second %>
                  <div class="flex items-center gap-3">
                    <div class="avatar">
                      <div class="w-12 h-12 mask mask-squircle">
                        <%= image_tag output_file.variant(:thumb) %>
                      </div>
                    </div>
                    <div>
                      <div class="font-bold"><%= output_file.filename.to_s %></div>
                      <div class="text-sm opacity-50"><%= upload.updated_at.to_s %></div>
                    </div>
                  </div>
                <% end %>
              </td>
              <td> <%= render "uploads/status_badge", upload: upload %></td>
              <th>
                <%= link_to "Details", upload_path(upload), class: "btn bg-base-500 border border-violet-300 btn-xs" %>
              </th>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </tbody>
    <tfoot>
      <tr>
        <th></th>
        <th>Input</th>
        <th>Output</th>
        <th>Status</th>
        <th></th>
      </tr>
    </tfoot>
  </table>
<% else %>
  <%= render 'uploads/no_search_results' %>
<% end %>
